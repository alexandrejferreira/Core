"use strict";

/*
 * MikoPBX - free phone system for small business
 * Copyright (C) 2017-2023 Alexey Portnov and Nikolay Beketov
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along with this program.
 * If not, see <https://www.gnu.org/licenses/>.
 */

/* global globalRootUrl, PbxApi, DebuggerInfo, SemanticLocalization, sessionStorage */
var providers = {
  $deleteModalForm: $('#delete-modal-form'),
  $providersTable: $('#providers-table'),
  initialize: function initialize() {
    providers.$deleteModalForm.modal();
    $('.provider-row .checkbox').checkbox({
      onChecked: function onChecked() {
        var uniqid = $(this).closest('tr').attr('id');
        $.api({
          url: "".concat(globalRootUrl, "providers/enable/{type}/{uniqid}"),
          on: 'now',
          urlData: {
            type: $(this).closest('tr').attr('data-value'),
            uniqid: uniqid
          },
          onSuccess: function onSuccess(response) {
            if (response.success) {
              $("#".concat(uniqid, " .disability")).removeClass('disabled');
            }
          }
        });
      },
      onUnchecked: function onUnchecked() {
        var uniqid = $(this).closest('tr').attr('id');
        $.api({
          url: "".concat(globalRootUrl, "providers/disable/{type}/{uniqid}"),
          on: 'now',
          urlData: {
            type: $(this).closest('tr').attr('data-value'),
            uniqid: uniqid
          },
          onSuccess: function onSuccess(response) {
            if (response.success) {
              $("#".concat(uniqid, " .disability")).addClass('disabled');
            }
          }
        });
      }
    });
    $('.provider-row td').on('dblclick', function (e) {
      var id = $(e.target).closest('tr').attr('id');
      var type = $(e.target).closest('tr').attr('data-value');
      window.location = "".concat(globalRootUrl, "providers/modify").concat(type, "/").concat(id);
    });
    $('body').on('click', '.provider-row a.delete', function (e) {
      e.preventDefault();
      var linksExist = $(e.target).closest('tr').attr('data-links');

      if (linksExist === 'true') {
        providers.$deleteModalForm.modal({
          closable: false,
          onDeny: function onDeny() {
            return true;
          },
          onApprove: function onApprove() {
            window.location = $(e.target).closest('a').attr('href');
            return true;
          }
        }).modal('show');
      } else {
        window.location = $(e.target).closest('a').attr('href');
      }
    });
    providers.initializeDataTable();
  },

  /**
   * Initialize data tables on table
   */
  initializeDataTable: function initializeDataTable() {
    providers.$providersTable.DataTable({
      lengthChange: false,
      paging: false,
      columns: [null, null, null, {
        "width": "0"
      }, null, null, {
        orderable: false,
        searchable: false
      }],
      autoWidth: false,
      order: [1, 'asc'],
      language: SemanticLocalization.dataTableLocalisation
    });
    $('.add-new-button').appendTo($('div.eight.column:eq(0)'));
  }
};
var providersStatusLoopWorker = {
  timeOut: 3000,
  timeOutHandle: '',
  providerStatuses: {},
  initialize: function initialize() {
    // Запустим обновление статуса провайдера
    DebuggerInfo.initialize();
    var previousStatuses = sessionStorage.getItem('ProviderStatuses');

    if (previousStatuses !== null) {
      providersStatusLoopWorker.providerStatuses = JSON.parse(previousStatuses);
    }

    providersStatusLoopWorker.restartWorker();
  },
  restartWorker: function restartWorker() {
    window.clearTimeout(providersStatusLoopWorker.timeoutHandle);
    providersStatusLoopWorker.worker();
  },
  worker: function worker() {
    window.clearTimeout(providersStatusLoopWorker.timeoutHandle);
    PbxApi.GetSipProvidersStatuses(providersStatusLoopWorker.cbRefreshProvidersStatus);
    PbxApi.GetIaxProvidersStatuses(providersStatusLoopWorker.cbRefreshProvidersStatus);
  },

  /**
   * Накопление информации о статусах провайдеров
   */
  cbRefreshProvidersStatus: function cbRefreshProvidersStatus(response) {
    providersStatusLoopWorker.timeoutHandle = window.setTimeout(providersStatusLoopWorker.worker, providersStatusLoopWorker.timeOut);
    if (response.length === 0 || response === false) return;
    $.each(response, function (key, value) {
      if (value.state !== undefined) {
        providersStatusLoopWorker.providerStatuses[value.id] = value.state.toUpperCase();
      }
    });
    sessionStorage.setItem('ProviderStatuses', JSON.stringify(providersStatusLoopWorker.providerStatuses));
    providersStatusLoopWorker.refreshVisualisation();
  },

  /**
   * Обновление информации в таблице провайдеров
   */
  refreshVisualisation: function refreshVisualisation() {
    var htmlTable = '<table class="ui very compact table">';
    $.each(providersStatusLoopWorker.providerStatuses, function (key, value) {
      htmlTable += '<tr>';
      htmlTable += "<td>".concat(key, "</td>");
      htmlTable += "<td>".concat(value, "</td>");
      htmlTable += '</tr>';
    });
    htmlTable += '</table>';
    DebuggerInfo.UpdateContent(htmlTable);
    var green = '<div class="ui green empty circular label" style="width: 1px;height: 1px;"></div>';
    var grey = '<div class="ui grey empty circular label" style="width: 1px;height: 1px;"></div>';
    var yellow = '<div class="ui yellow empty circular label" style="width: 1px;height: 1px;"></div>';
    $('tr.provider-row').each(function (index, obj) {
      var uniqid = $(obj).attr('id');

      if (providersStatusLoopWorker.providerStatuses[uniqid] !== undefined) {
        switch (providersStatusLoopWorker.providerStatuses[uniqid]) {
          case 'REGISTERED':
            $(obj).find('.provider-status').html(green);
            $(obj).find('.failure').text('');
            break;

          case 'OK':
            $(obj).find('.provider-status').html(yellow);
            $(obj).find('.failure').text('');
            break;

          case 'OFF':
            $(obj).find('.provider-status').html(grey);
            $(obj).find('.failure').text('');
            break;

          default:
            $(obj).find('.provider-status').html(grey);
            $(obj).find('.failure').text(providersStatusLoopWorker.providerStatuses[uniqid]);
            break;
        }
      } else {
        $(obj).find('.provider-status').html(grey);
      }
    });
  }
};
$(document).ready(function () {
  providers.initialize();
  providersStatusLoopWorker.initialize();
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9Qcm92aWRlcnMvcHJvdmlkZXJzLWluZGV4LmpzIl0sIm5hbWVzIjpbInByb3ZpZGVycyIsIiRkZWxldGVNb2RhbEZvcm0iLCIkIiwiJHByb3ZpZGVyc1RhYmxlIiwiaW5pdGlhbGl6ZSIsIm1vZGFsIiwiY2hlY2tib3giLCJvbkNoZWNrZWQiLCJ1bmlxaWQiLCJjbG9zZXN0IiwiYXR0ciIsImFwaSIsInVybCIsImdsb2JhbFJvb3RVcmwiLCJvbiIsInVybERhdGEiLCJ0eXBlIiwib25TdWNjZXNzIiwicmVzcG9uc2UiLCJzdWNjZXNzIiwicmVtb3ZlQ2xhc3MiLCJvblVuY2hlY2tlZCIsImFkZENsYXNzIiwiZSIsImlkIiwidGFyZ2V0Iiwid2luZG93IiwibG9jYXRpb24iLCJwcmV2ZW50RGVmYXVsdCIsImxpbmtzRXhpc3QiLCJjbG9zYWJsZSIsIm9uRGVueSIsIm9uQXBwcm92ZSIsImluaXRpYWxpemVEYXRhVGFibGUiLCJEYXRhVGFibGUiLCJsZW5ndGhDaGFuZ2UiLCJwYWdpbmciLCJjb2x1bW5zIiwib3JkZXJhYmxlIiwic2VhcmNoYWJsZSIsImF1dG9XaWR0aCIsIm9yZGVyIiwibGFuZ3VhZ2UiLCJTZW1hbnRpY0xvY2FsaXphdGlvbiIsImRhdGFUYWJsZUxvY2FsaXNhdGlvbiIsImFwcGVuZFRvIiwicHJvdmlkZXJzU3RhdHVzTG9vcFdvcmtlciIsInRpbWVPdXQiLCJ0aW1lT3V0SGFuZGxlIiwicHJvdmlkZXJTdGF0dXNlcyIsIkRlYnVnZ2VySW5mbyIsInByZXZpb3VzU3RhdHVzZXMiLCJzZXNzaW9uU3RvcmFnZSIsImdldEl0ZW0iLCJKU09OIiwicGFyc2UiLCJyZXN0YXJ0V29ya2VyIiwiY2xlYXJUaW1lb3V0IiwidGltZW91dEhhbmRsZSIsIndvcmtlciIsIlBieEFwaSIsIkdldFNpcFByb3ZpZGVyc1N0YXR1c2VzIiwiY2JSZWZyZXNoUHJvdmlkZXJzU3RhdHVzIiwiR2V0SWF4UHJvdmlkZXJzU3RhdHVzZXMiLCJzZXRUaW1lb3V0IiwibGVuZ3RoIiwiZWFjaCIsImtleSIsInZhbHVlIiwic3RhdGUiLCJ1bmRlZmluZWQiLCJ0b1VwcGVyQ2FzZSIsInNldEl0ZW0iLCJzdHJpbmdpZnkiLCJyZWZyZXNoVmlzdWFsaXNhdGlvbiIsImh0bWxUYWJsZSIsIlVwZGF0ZUNvbnRlbnQiLCJncmVlbiIsImdyZXkiLCJ5ZWxsb3ciLCJpbmRleCIsIm9iaiIsImZpbmQiLCJodG1sIiwidGV4dCIsImRvY3VtZW50IiwicmVhZHkiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUVBLElBQU1BLFNBQVMsR0FBRztBQUNqQkMsRUFBQUEsZ0JBQWdCLEVBQUVDLENBQUMsQ0FBQyxvQkFBRCxDQURGO0FBRWpCQyxFQUFBQSxlQUFlLEVBQUVELENBQUMsQ0FBQyxrQkFBRCxDQUZEO0FBR2pCRSxFQUFBQSxVQUhpQix3QkFHSjtBQUNaSixJQUFBQSxTQUFTLENBQUNDLGdCQUFWLENBQTJCSSxLQUEzQjtBQUNBSCxJQUFBQSxDQUFDLENBQUMseUJBQUQsQ0FBRCxDQUNFSSxRQURGLENBQ1c7QUFDVEMsTUFBQUEsU0FEUyx1QkFDRztBQUNYLFlBQU1DLE1BQU0sR0FBR04sQ0FBQyxDQUFDLElBQUQsQ0FBRCxDQUFRTyxPQUFSLENBQWdCLElBQWhCLEVBQXNCQyxJQUF0QixDQUEyQixJQUEzQixDQUFmO0FBQ0FSLFFBQUFBLENBQUMsQ0FBQ1MsR0FBRixDQUFNO0FBQ0xDLFVBQUFBLEdBQUcsWUFBS0MsYUFBTCxxQ0FERTtBQUVMQyxVQUFBQSxFQUFFLEVBQUUsS0FGQztBQUdMQyxVQUFBQSxPQUFPLEVBQUU7QUFDUkMsWUFBQUEsSUFBSSxFQUFFZCxDQUFDLENBQUMsSUFBRCxDQUFELENBQVFPLE9BQVIsQ0FBZ0IsSUFBaEIsRUFBc0JDLElBQXRCLENBQTJCLFlBQTNCLENBREU7QUFFUkYsWUFBQUEs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S0F4QkQ7QUF5QkE7QUE5RWdDLENBQWxDO0FBaUZBNUUsQ0FBQyxDQUFDbUYsUUFBRCxDQUFELENBQVlDLEtBQVosQ0FBa0IsWUFBTTtBQUN2QnRGLEVBQUFBLFNBQVMsQ0FBQ0ksVUFBVjtBQUNBMEMsRUFBQUEseUJBQXlCLENBQUMxQyxVQUExQjtBQUNBLENBSEQiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogTWlrb1BCWCAtIGZyZWUgcGhvbmUgc3lzdGVtIGZvciBzbWFsbCBidXNpbmVzc1xuICogQ29weXJpZ2h0IChDKSAyMDE3LTIwMjMgQWxleGV5IFBvcnRub3YgYW5kIE5pa29sYXkgQmVrZXRvdlxuICpcbiAqIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5XG4gKiBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieVxuICogdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3JcbiAqIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uXG4gKlxuICogVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsXG4gKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZlxuICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZVxuICogR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy5cbiAqXG4gKiBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS5cbiAqIElmIG5vdCwgc2VlIDxodHRwczovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uXG4gKi9cblxuLyogZ2xvYmFsIGdsb2JhbFJvb3RVcmwsIFBieEFwaSwgRGVidWdnZXJJbmZvLCBTZW1hbnRpY0xvY2FsaXphdGlvbiwgc2Vzc2lvblN0b3JhZ2UgKi9cblxuY29uc3QgcHJvdmlkZXJzID0ge1xuXHQkZGVsZXRlTW9kYWxGb3JtOiAkKCcjZGVsZXRlLW1vZGFsLWZvcm0nKSxcblx0JHByb3ZpZGVyc1RhYmxlOiAkKCcjcHJvdmlkZXJzLXRhYmxlJyksXG5cdGluaXRpYWxpemUoKSB7XG5cdFx0cHJvdmlkZXJzLiRkZWxldGVNb2RhbEZvcm0ubW9kYWwoKTtcblx0XHQkKCcucHJvdmlkZXItcm93IC5jaGVja2JveCcpXG5cdFx0XHQuY2hlY2tib3goe1xuXHRcdFx0XHRvbkNoZWNrZWQoKSB7XG5cdFx0XHRcdFx0Y29uc3QgdW5pcWlkID0gJCh0aGlzKS5jbG9zZXN0KCd0cicpLmF0dHIoJ2lkJyk7XG5cdFx0XHRcdFx0JC5hcGkoe1xuXHRcdFx0XHRcdFx0dXJsOiBgJHtnbG9iYWxSb290VXJsfXByb3ZpZGVycy9lbmFibGUve3R5cGV9L3t1bmlxaWR9YCxcblx0XHRcdFx0XHRcdG9uOiAnbm93Jyxcblx0XHRcdFx0XHRcdHVybERhdGE6IHtcblx0XHRcdFx0XHRcdFx0dHlwZTogJCh0aGlzKS5jbG9zZXN0KCd0cicpLmF0dHIoJ2RhdGEtdmFsdWUnKSxcblx0XHRcdFx0XHRcdFx0dW5pcWlkLFxuXHRcdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRcdG9uU3VjY2VzcyhyZXNwb25zZSkge1xuXHRcdFx0XHRcdFx0XHRpZiAocmVzcG9uc2Uuc3VjY2Vzcykge1xuXHRcdFx0XHRcdFx0XHRcdCQoYCMke3VuaXFpZH0gLmRpc2FiaWxpdHlgKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSxcblxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRvblVuY2hlY2tlZCgpIHtcblx0XHRcdFx0XHRjb25zdCB1bmlxaWQgPSAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuYXR0cignaWQnKTtcblx0XHRcdFx0XHQkLmFwaSh7XG5cdFx0XHRcdFx0XHR1cmw6IGAke2dsb2JhbFJvb3RVcmx9cHJvdmlkZXJzL2Rpc2FibGUve3R5cGV9L3t1bmlxaWR9YCxcblx0XHRcdFx0XHRcdG9uOiAnbm93Jyxcblx0XHRcdFx0XHRcdHVybERhdGE6IHtcblx0XHRcdFx0XHRcdFx0dHlwZTogJCh0aGlzKS5jbG9zZXN0KCd0cicpLmF0dHIoJ2RhdGEtdmFsdWUnKSxcblx0XHRcdFx0XHRcdFx0dW5pcWlkLFxuXHRcdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRcdG9uU3VjY2VzcyhyZXNwb25zZSkge1xuXHRcdFx0XHRcdFx0XHRpZiAocmVzcG9uc2Uuc3VjY2Vzcykge1xuXHRcdFx0XHRcdFx0XHRcdCQoYCMke3VuaXFpZH0gLmRpc2FiaWxpdHlgKS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSxcblxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9LFxuXHRcdFx0fSk7XG5cblx0XHQkKCcucHJvdmlkZXItcm93IHRkJykub24oJ2RibGNsaWNrJywgKGUpID0+IHtcblx0XHRcdGNvbnN0IGlkID0gJChlLnRhcmdldCkuY2xvc2VzdCgndHInKS5hdHRyKCdpZCcpO1xuXHRcdFx0Y29uc3QgdHlwZSA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoJ3RyJykuYXR0cignZGF0YS12YWx1ZScpO1xuXHRcdFx0d2luZG93LmxvY2F0aW9uID0gYCR7Z2xvYmFsUm9vdFVybH1wcm92aWRlcnMvbW9kaWZ5JHt0eXBlfS8ke2lkfWA7XG5cdFx0fSk7XG5cblx0XHQkKCdib2R5Jykub24oJ2NsaWNrJywgJy5wcm92aWRlci1yb3cgYS5kZWxldGUnLCAoZSkgPT4ge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0Y29uc3QgbGlua3NFeGlzdCA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoJ3RyJykuYXR0cignZGF0YS1saW5rcycpO1xuXHRcdFx0aWYgKGxpbmtzRXhpc3QgPT09ICd0cnVlJykge1xuXHRcdFx0XHRwcm92aWRlcnMuJGRlbGV0ZU1vZGFsRm9ybVxuXHRcdFx0XHRcdC5tb2RhbCh7XG5cdFx0XHRcdFx0XHRjbG9zYWJsZTogZmFsc2UsXG5cdFx0XHRcdFx0XHRvbkRlbnk6ICgpID0+IHRydWUsXG5cdFx0XHRcdFx0XHRvbkFwcHJvdmU6ICgpID0+IHtcblx0XHRcdFx0XHRcdFx0d2luZG93LmxvY2F0aW9uID0gJChlLnRhcmdldCkuY2xvc2VzdCgnYScpLmF0dHIoJ2hyZWYnKTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdH0pXG5cdFx0XHRcdFx0Lm1vZGFsKCdzaG93Jyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR3aW5kb3cubG9jYXRpb24gPSAkKGUudGFyZ2V0KS5jbG9zZXN0KCdhJykuYXR0cignaHJlZicpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdHByb3ZpZGVycy5pbml0aWFsaXplRGF0YVRhYmxlKCk7XG5cdH0sXG5cdC8qKlxuXHQgKiBJbml0aWFsaXplIGRhdGEgdGFibGVzIG9uIHRhYmxlXG5cdCAqL1xuXHRpbml0aWFsaXplRGF0YVRhYmxlKCkge1xuXHRcdHByb3ZpZGVycy4kcHJvdmlkZXJzVGFibGUuRGF0YVRhYmxlKHtcblx0XHRcdGxlbmd0aENoYW5nZTogZmFsc2UsXG5cdFx0XHRwYWdpbmc6IGZhbHNlLFxuXHRcdFx0Y29sdW1uczogW1xuXHRcdFx0XHRudWxsLFxuXHRcdFx0XHRudWxsLFxuXHRcdFx0XHRudWxsLFxuXHRcdFx0XHR7IFwid2lkdGhcIjogXCIwXCJ9LFxuXHRcdFx0XHRudWxsLFxuXHRcdFx0XHRudWxsLFxuXHRcdFx0XHR7b3JkZXJhYmxlOiBmYWxzZSwgc2VhcmNoYWJsZTogZmFsc2V9LFxuXHRcdFx0XSxcblx0XHRcdGF1dG9XaWR0aDogZmFsc2UsXG5cdFx0XHRvcmRlcjogWzEsICdhc2MnXSxcblx0XHRcdGxhbmd1YWdlOiBTZW1hbnRpY0xvY2FsaXphdGlvbi5kYXRhVGFibGVMb2NhbGlzYXRpb24sXG5cdFx0fSk7XG5cdFx0JCgnLmFkZC1uZXctYnV0dG9uJykuYXBwZW5kVG8oJCgnZGl2LmVpZ2h0LmNvbHVtbjplcSgwKScpKTtcblx0fSxcbn07XG5jb25zdCBwcm92aWRlcnNTdGF0dXNMb29wV29ya2VyID0ge1xuXHR0aW1lT3V0OiAzMDAwLFxuXHR0aW1lT3V0SGFuZGxlOiAnJyxcblx0cHJvdmlkZXJTdGF0dXNlczoge30sXG5cdGluaXRpYWxpemUoKSB7XG5cdFx0Ly8g0JfQsNC/0YPRgdGC0LjQvCDQvtCx0L3QvtCy0LvQtdC90LjQtSDRgdGC0LDRgtGD0YHQsCDQv9GA0L7QstCw0LnQtNC10YDQsFxuXHRcdERlYnVnZ2VySW5mby5pbml0aWFsaXplKCk7XG5cdFx0Y29uc3QgcHJldmlvdXNTdGF0dXNlcyA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ1Byb3ZpZGVyU3RhdHVzZXMnKTtcblx0XHRpZiAocHJldmlvdXNTdGF0dXNlcyAhPT0gbnVsbCkge1xuXHRcdFx0cHJvdmlkZXJzU3RhdHVzTG9vcFdvcmtlci5wcm92aWRlclN0YXR1c2VzID0gSlNPTi5wYXJzZShwcmV2aW91c1N0YXR1c2VzKTtcblx0XHR9XG5cdFx0cHJvdmlkZXJzU3RhdHVzTG9vcFdvcmtlci5yZXN0YXJ0V29ya2VyKCk7XG5cdH0sXG5cdHJlc3RhcnRXb3JrZXIoKSB7XG5cdFx0d2luZG93LmNsZWFyVGltZW91dChwcm92aWRlcnNTdGF0dXNMb29wV29ya2VyLnRpbWVvdXRIYW5kbGUpO1xuXHRcdHByb3ZpZGVyc1N0YXR1c0xvb3BXb3JrZXIud29ya2VyKCk7XG5cdH0sXG5cdHdvcmtlcigpIHtcblx0XHR3aW5kb3cuY2xlYXJUaW1lb3V0KHByb3ZpZGVyc1N0YXR1c0xvb3BXb3JrZXIudGltZW91dEhhbmRsZSk7XG5cdFx0UGJ4QXBpLkdldFNpcFByb3ZpZGVyc1N0YXR1c2VzKHByb3ZpZGVyc1N0YXR1c0xvb3BXb3JrZXIuY2JSZWZyZXNoUHJvdmlkZXJzU3RhdHVzKTtcblx0XHRQYnhBcGkuR2V0SWF4UHJvdmlkZXJzU3RhdHVzZXMocHJvdmlkZXJzU3RhdHVzTG9vcFdvcmtlci5jYlJlZnJlc2hQcm92aWRlcnNTdGF0dXMpO1xuXHR9LFxuXHQvKipcblx0ICog0J3QsNC60L7Qv9C70LXQvdC40LUg0LjQvdGE0L7RgNC80LDRhtC40Lgg0L4g0YHRgtCw0YLRg9GB0LDRhSDQv9GA0L7QstCw0LnQtNC10YDQvtCyXG5cdCAqL1xuXHRjYlJlZnJlc2hQcm92aWRlcnNTdGF0dXMocmVzcG9uc2UpIHtcblx0XHRwcm92aWRlcnNTdGF0dXNMb29wV29ya2VyLnRpbWVvdXRIYW5kbGUgPVxuXHRcdFx0d2luZG93LnNldFRpbWVvdXQocHJvdmlkZXJzU3RhdHVzTG9vcFdvcmtlci53b3JrZXIsIHByb3ZpZGVyc1N0YXR1c0xvb3BXb3JrZXIudGltZU91dCk7XG5cdFx0aWYgKHJlc3BvbnNlLmxlbmd0aCA9PT0gMCB8fCByZXNwb25zZSA9PT0gZmFsc2UpIHJldHVybjtcblx0XHQkLmVhY2gocmVzcG9uc2UsIChrZXksIHZhbHVlKSA9PiB7XG5cdFx0XHRpZiAodmFsdWUuc3RhdGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRwcm92aWRlcnNTdGF0dXNMb29wV29ya2VyLnByb3ZpZGVyU3RhdHVzZXNbdmFsdWUuaWRdID0gdmFsdWUuc3RhdGUudG9VcHBlckNhc2UoKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdQcm92aWRlclN0YXR1c2VzJywgSlNPTi5zdHJpbmdpZnkocHJvdmlkZXJzU3RhdHVzTG9vcFdvcmtlci5wcm92aWRlclN0YXR1c2VzKSk7XG5cdFx0cHJvdmlkZXJzU3RhdHVzTG9vcFdvcmtlci5yZWZyZXNoVmlzdWFsaXNhdGlvbigpO1xuXHR9LFxuXHQvKipcblx0ICog0J7QsdC90L7QstC70LXQvdC40LUg0LjQvdGE0L7RgNC80LDRhtC40Lgg0LIg0YLQsNCx0LvQuNGG0LUg0L/RgNC+0LLQsNC50LTQtdGA0L7QslxuXHQgKi9cblx0cmVmcmVzaFZpc3VhbGlzYXRpb24oKSB7XG5cdFx0bGV0IGh0bWxUYWJsZSA9ICc8dGFibGUgY2xhc3M9XCJ1aSB2ZXJ5IGNvbXBhY3QgdGFibGVcIj4nO1xuXHRcdCQuZWFjaChwcm92aWRlcnNTdGF0dXNMb29wV29ya2VyLnByb3ZpZGVyU3RhdHVzZXMsIChrZXksIHZhbHVlKSA9PiB7XG5cdFx0XHRodG1sVGFibGUgKz0gJzx0cj4nO1xuXHRcdFx0aHRtbFRhYmxlICs9IGA8dGQ+JHtrZXl9PC90ZD5gO1xuXHRcdFx0aHRtbFRhYmxlICs9IGA8dGQ+JHt2YWx1ZX08L3RkPmA7XG5cdFx0XHRodG1sVGFibGUgKz0gJzwvdHI+Jztcblx0XHR9KTtcblx0XHRodG1sVGFibGUgKz0gJzwvdGFibGU+Jztcblx0XHREZWJ1Z2dlckluZm8uVXBkYXRlQ29udGVudChodG1sVGFibGUpO1xuXHRcdGNvbnN0IGdyZWVuID0gJzxkaXYgY2xhc3M9XCJ1aSBncmVlbiBlbXB0eSBjaXJjdWxhciBsYWJlbFwiIHN0eWxlPVwid2lkdGg6IDFweDtoZWlnaHQ6IDFweDtcIj48L2Rpdj4nO1xuXHRcdGNvbnN0IGdyZXkgPSAnPGRpdiBjbGFzcz1cInVpIGdyZXkgZW1wdHkgY2lyY3VsYXIgbGFiZWxcIiBzdHlsZT1cIndpZHRoOiAxcHg7aGVpZ2h0OiAxcHg7XCI+PC9kaXY+Jztcblx0XHRjb25zdCB5ZWxsb3cgPSAnPGRpdiBjbGFzcz1cInVpIHllbGxvdyBlbXB0eSBjaXJjdWxhciBsYWJlbFwiIHN0eWxlPVwid2lkdGg6IDFweDtoZWlnaHQ6IDFweDtcIj48L2Rpdj4nO1xuXHRcdCQoJ3RyLnByb3ZpZGVyLXJvdycpLmVhY2goKGluZGV4LCBvYmopID0+IHtcblx0XHRcdGNvbnN0IHVuaXFpZCA9ICQob2JqKS5hdHRyKCdpZCcpO1xuXHRcdFx0aWYgKHByb3ZpZGVyc1N0YXR1c0xvb3BXb3JrZXIucHJvdmlkZXJTdGF0dXNlc1t1bmlxaWRdICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0c3dpdGNoIChwcm92aWRlcnNTdGF0dXNMb29wV29ya2VyLnByb3ZpZGVyU3RhdHVzZXNbdW5pcWlkXSkge1xuXHRcdFx0XHRcdGNhc2UgJ1JFR0lTVEVSRUQnOlxuXHRcdFx0XHRcdFx0JChvYmopLmZpbmQoJy5wcm92aWRlci1zdGF0dXMnKS5odG1sKGdyZWVuKTtcblx0XHRcdFx0XHRcdCQob2JqKS5maW5kKCcuZmFpbHVyZScpLnRleHQoJycpO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSAnT0snOlxuXHRcdFx0XHRcdFx0JChvYmopLmZpbmQoJy5wcm92aWRlci1zdGF0dXMnKS5odG1sKHllbGxvdyk7XG5cdFx0XHRcdFx0XHQkKG9iaikuZmluZCgnLmZhaWx1cmUnKS50ZXh0KCcnKTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgJ09GRic6XG5cdFx0XHRcdFx0XHQkKG9iaikuZmluZCgnLnByb3ZpZGVyLXN0YXR1cycpLmh0bWwoZ3JleSk7XG5cdFx0XHRcdFx0XHQkKG9iaikuZmluZCgnLmZhaWx1cmUnKS50ZXh0KCcnKTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0XHQkKG9iaikuZmluZCgnLnByb3ZpZGVyLXN0YXR1cycpLmh0bWwoZ3JleSk7XG5cdFx0XHRcdFx0XHQkKG9iaikuZmluZCgnLmZhaWx1cmUnKS50ZXh0KHByb3ZpZGVyc1N0YXR1c0xvb3BXb3JrZXIucHJvdmlkZXJTdGF0dXNlc1t1bmlxaWRdKTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQkKG9iaikuZmluZCgnLnByb3ZpZGVyLXN0YXR1cycpLmh0bWwoZ3JleSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0sXG59O1xuXG4kKGRvY3VtZW50KS5yZWFkeSgoKSA9PiB7XG5cdHByb3ZpZGVycy5pbml0aWFsaXplKCk7XG5cdHByb3ZpZGVyc1N0YXR1c0xvb3BXb3JrZXIuaW5pdGlhbGl6ZSgpO1xufSk7XG4iXX0=